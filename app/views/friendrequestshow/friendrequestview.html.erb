<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    function Friendrequestdeclined(friendemail){
        data={userid:`<%=current_user.id%>`,currentuseremail:friendemail,user_id:`<%=current_user.id%>`,reqstatus:"declined"}
        axios.post('/friendrequestsent/friendrequestdelete',data)
        .then((response) => {
            if(response.status==200){
                window.location.reload();
            } 
        }).catch(error => console.log(error.response.data));
    }
    function Friendrequestaccepted(friendemail){ 
        console.log("inside friend request method")
        data={userid:`<%=current_user.id%>`,currentuseremail:friendemail,user_id:`<%=current_user.id%>`,reqstatus:"accept"}
        axios.post('/friendrequestsent/friendrequestaccept',data)
        .then((response) => {
            if(response.status==200){ 
                window.location.reload();
            }
        })
        .catch(error => console.log(error.response.data));
    }
    function RequestSent(email,id){
        console.log("function request sent",email,"::::::::::",id);
        data={emails:email,userid:id,currentuseremail:`<%=current_user.email%>`,user_id:id,reqstatus:"pending"}
        axios.post('/friendrequestsent/friendrequestget',data)
        .then((response) => {
            if(response.status==200){ 
                window.location.reload();
            }
        })
        .catch(error => console.log(error.response.data));
    }
</script>

<div class="flex flex-row">
    <div style="z-index:90" class="shadow-lg h-1670 shadow-slate-900/20 shadow-b-2 shadow-r-[3px]  bg-[rgb(255,255,255)] w-90 h-screen  border-[rgb(235,235,235)]">
        <div class="w-88 h-35">
            <div class="w-88 h-35 bg-[rgb(255,255,255)] flex items-center justify-center">
                <div class="w-88 h-35 bg-[rgb(255,255,255)]">
                    <div class="h-18 bg-[rgb(255,255,255)] flex">
                        <div class="w-15 bg-[rgb(255,255,255)] flex  items-center justify-center">
                            <a href="http://127.0.0.1:3000/people">
                            <div class="w-8 h-8 rounded-full bg-[rgb(255,255,255)]">
                                <div class="w-8 h-8 rounded-full hover:bg-[rgb(242,242,242)] flex justify-center items-center cursor-pointer">
                                    <i data-visualcompletion="css-img" class="x1b0d499 x1d69dk1" style="background-image: url(&quot;https://static.xx.fbcdn.net/rsrc.php/v4/yP/r/vX10Saq43DO.png&quot;); background-position: 0px -125px; background-size: auto; width: 20px; height: 20px; background-repeat: no-repeat; display: inline-block;"></i>
                                </div>
                            </div>
                            </a>
                        </div>
                        <div class="w-70 bg-[rgb(255,255,255)]">
                            <div class="h-5 bg-[rgb(255,255,255)] mt-4">
                                <div class="text-sm text-[rgb(101,104,151)] font-[600] cursor-pointer hover:underline">
                                    Friends
                                </div>
                            </div>
                            <div class="h-8 bg-[rgb(255,255,255)]">
                                <div class="w-65 h-8 bg-[rgb(255,255,255)] flex justify-center">
                                    <div class="w-63 bg-[rgb(255,255,255)] text-2xl font-[700] flex items-center">
                                        <div class="h-8">
                                            Friend requests
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="h-7 bg-[rgb(255,255,255)] flex justify-start">
                        <div class="w-60 h-6 ">
                            <div class="flex  h-6 w-55 flex justify-center">
                                <div class="w-45 h-6 text-lg flex justify-around font-[600]">
                                    <div>
                                        <%=current_user.friends.where(req_status:"pending").count%>
                                    </div>
                                    <div class="w-40">
                                        friend request
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="w-60 h-6  flex justify-center">
                        <div class="w-48 text-[rgb(127,177,231)] cursor-pointer">
                            view sent requests
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <% current_user.friends.each do |requests| %>
            <% if requests.req_status == 'pending' %>
        <div class="flex flex-col">
            <div onclick="OpenProfileModal('currentuser<%=requests.friend_email%>')" style="z-index:90" class="  h-20 flex items-center hover:bg-[rgb(242,242,242)]  rounded-lg bg-[rgb(255,255,255)]   ">
                <div class="w-17 h-17 rounded-full flex justify-center items-center">
                    <div class="w-14 h-15">
                        <svg class="rounded-full" style="height: 60px; width: 60px;"><image class="rounded-full" x="0" y="0" height="60%" preserveAspectRatio="xMidYMid slice" width="60%" xlink:href="https://scontent.fixc1-7.fna.fbcdn.net/v/t1.30497-1/453178253_471506465671661_2781666950760530985_n.png?stp=cp0_dst-png_s56x56&amp;_nc_cat=1&amp;ccb=1-7&amp;_nc_sid=22ec41&amp;_nc_ohc=mHBMWDB1Di8Q7kNvwG_JdBl&amp;_nc_oc=Adme-l7M2Tjo7t0q36eKNvREx8fIeDi9t44pFc625AT5Pwusxl2U9xjjBfTqQqPjnpGHGucAqJ6nbSzUKb3SoibC&amp;_nc_zt=24&amp;_nc_ht=scontent.fixc1-7.fna&amp;oh=00_AfGk0l_mT0QMIVWNzT4EoZjNSXMf7W6oDkbSj8leqntoPg&amp;oe=682D94BA" style=" height: 60px; width: 60px; border-radius:100%"></image></svg>
                    </div>
                </div>
                <div class=" h-20 font-[500] flex flex-col">
                    <div class="h-8 pl-2">
                        <%=requests.friend_email%>
                    </div>
                    <div class="w-66 h-9 flex justify-around ">
                        <div class="w-32 h-9 bg-[rgb(255,255,255)] rounded-lg">
                            <button onclick="Friendrequestaccepted(`<%=requests.friend_email%>`)" class="cursor-pointer text-white bg-blue-600 font-[500] w-32 bg-[rgb(255,255,255)] h-9 rounded-lg">Confirm</button>
                        </div>
                        <div class="w-32 h-9 bg-[rgb(255,255,255)] rounded-lg">
                            <button onclick="Friendrequestdeclined(`<%=requests.friend_email%>`)" class="cursor-pointer w-32 font-[500] bg-[rgb(214,217,221)] h-9 rounded-lg">Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <%end%>
        <%end%>
    </div>
    <div id="Parentprofilediv">
        <% current_user.friends.each do |requests| %>
            <% if requests.req_status == 'pending' %>
        <div id='currentuser<%=requests.friend_email%>' style="display:none" class="w-286 h-220 bg-[rgb(255,255,255)] flex justify-center">
            <div class="w-286  absolute">
                <div class="w-286 flex justify-center">
                    <div class="w-240 h-82 bg-[rgb(242,244,247)]">
                    </div>
                </div>
                <div class="w-286 flex relative  top-9 left-4">
                   <div class="w-286 flex flex-col h-102 justify-center">
                        <div>
                            <div>
                                <div class="flex justify-center h-51">
                                    <div class="flex w-240 justify-center">
                                        <div class="flex">
                                            <div class="w-47 h-47 flex justify-center ">
                                                <div class="w-47 h-47 flex items-end">
                                                    <div class="w-47 h-47 rounded-full bg-[rgb(255,255,255)] flex justify-center items-center">
                                                        <div class="w-45 h-45 bg-[rgb(255,255,255)] rounded-full ">
                                                            <div class="w-45 h-45 rounded-full">
                                                                <svg class="rounded-full" style="height: 179px; width: 179px;"><image class="rounded-full" x="0" y="0" height="180%" preserveAspectRatio="xMidYMid slice" width="180%" xlink:href="https://scontent.fixc1-7.fna.fbcdn.net/v/t1.30497-1/453178253_471506465671661_2781666950760530985_n.png?stp=cp0_dst-png_s56x56&amp;_nc_cat=1&amp;ccb=1-7&amp;_nc_sid=22ec41&amp;_nc_ohc=mHBMWDB1Di8Q7kNvwG_JdBl&amp;_nc_oc=Adme-l7M2Tjo7t0q36eKNvREx8fIeDi9t44pFc625AT5Pwusxl2U9xjjBfTqQqPjnpGHGucAqJ6nbSzUKb3SoibC&amp;_nc_zt=24&amp;_nc_ht=scontent.fixc1-7.fna&amp;oh=00_AfGk0l_mT0QMIVWNzT4EoZjNSXMf7W6oDkbSj8leqntoPg&amp;oe=682D94BA" style=" height: 184px; width: 184px; border-radius:100%"></image></svg>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="w-185 h-50  flex flex-col items-end">
                                                <div class="w-185 h-15 bg-[rgb(242,244,247)]">
                                                </div>
                                                <div class="w-185 h-25 mt-25 bg-[rgb(255,255,255)] flex justify-center">
                                                    <div class="w-185 h-25 flex bg-[rgb(255,255,255)]  font-[700]">
                                                        <div class="text-4xl">
                                                            <div class="pl-2">
                                                                <%=requests.friend_email%>
                                                            </div>
                                                        </div>
                                                        <div class="w-195 h-19 bg-[rgb(255,255,255)] flex items-end justify-end">
                                                            <div class="w-60 h-10 flex justify-between bg-[rgb(255,255,255)] text-md">
                                                                <div class="w-32 h-11 ">
                                                                    <button class="w-28 h-9 bg-blue-600 rounded-md text-[rgb(255,255,255)]  pl-4 cursor-pointer"> Respond</button>
                                                                    <img class="cursor-pointer x1b0d499 xaj1gnb relative -top-7 left-2" alt="" aria-hidden="true" height="16" width="16" src="https://static.xx.fbcdn.net/rsrc.php/v4/yF/r/5nzjDogBZbf.png">
                                                                </div>
                                                                <div class="w-32 h-15">
                                                                    <button class=" cursor-pointer w-28 h-9 bg-[rgb(214,217,221)] pl-4 text-md rounded-md">Message</button>
                                                                    <svg class="cursor-pointer w-4 h-4 relative -top-6 left-2 " xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 16 16" id="messenger">
                                                                    <path d="M8 0C3.582 0 0 3.316 0 7.407c0 2.331 1.163 4.41 2.981 5.768V16l2.724-1.495c.727.201 1.497.31 2.295.31 4.418 0 8-3.316 8-7.407S12.418 0 8 0zm.795 9.975L6.758 7.802 2.783 9.975l4.373-4.642 2.087 2.173 3.925-2.173-4.373 4.642z"></path>
                                                                    </svg>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-282 h-34 bg-[rgb(255,255,255)] flex flex-col items-center">
                                    <div class="w-250 h-23 flex items-center ">
                                        <div class="flex w-250 h-23 flex-col items-center">
                                            <div class="w-225 bg-[rgb(255,255,255)] h-22 flex rounded-lg">
                                                <div class="w-110 h-17 rounded-l-lg bg-[rgb(248,249,251)]">
                                                    <div>
                                                    </div>
                                                </div>
                                                <div class="w-170 rounded-r-lg bg-[rgb(248,249,251)] h-17 flex  items-center justify-end">
                                                    <div class="w-90 h-10 bg-[rgb(248,249,251)] flex justify-around">
                                                        <div class="h-10">
                                                            <button class="font-[700] w-40 h-10 bg-blue-600 rounded-md text-[rgb(255,255,255)] cursor-pointer"><!--img class="x1b0d499 xaj1gnb" src="https://static.xx.fbcdn.net/rsrc.php/v4/yF/r/5nzjDogBZbf.png" alt="" aria-hidden="true" height="6" width="6"--> Confirm Request</button>
                                                        </div>
                                                        <div class="h-10">
                                                            <button class="font-[700] w-40 h-10 bg-[rgb(214,217,221)] text-md rounded-md cursor-pointer">Delete Request</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="w-220 h-3 bg-[rgb(255,255,255)] flex items-center">
                                                <div class="w-220 h-0.5">
                                                    <hr class="border-none w-220 h-0.5 bg-[rgb(225,227,230)]" style="">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="w-225 h-11 bg-[rgb(255,255,255)] flex items-center">
                                        <div class="w-140 h-11 flex font-[600] justify-around text-[rgb(96,99,102)]">
                                            <div class="w-18 border-b-3 border-blue-500   cursor-pointer font-[600] h-11 bg-[rgb(255,255,255)] flex items-center justify-center">
                                                <div class="w-10 h-6 text-blue-600">
                                                    Posts
                                                </div>
                                            </div>
                                            <div class="w-18 rounded-md h-11 bg-[rgb(255,255,255)]  hover:bg-[rgb(242,242,242)] cursor-pointer    flex items-center justify-center">
                                                <div class="w-10 h-6">
                                                    About
                                                </div>
                                            </div>
                                            <div class="w-18 rounded-md h-11 bg-[rgb(255,255,255)]  hover:bg-[rgb(242,242,242)] cursor-pointer  flex justify-center items-center">
                                                <div class="w-10 h-6">
                                                    Friends
                                                </div>
                                            </div>
                                            <div class="w-18 rounded-md h-11 bg-[rgb(255,255,255)] hover:bg-[rgb(242,242,242)] cursor-pointer flex justify-center items-center">
                                                <div class="w-10 h-6">
                                                    Photos
                                                </div>
                                            </div>
                                            <div class="w-18 rounded-md h-11 bg-[rgb(255,255,255)] hover:bg-[rgb(242,242,242)] cursor-pointer flex justify-center items-center">
                                                <div class="w-10 h-6">
                                                    Videos
                                                </div>
                                            </div>
                                            <div class="w-18 rounded-md h-11  bg-[rgb(255,255,255)] hover:bg-[rgb(242,242,242)] cursor-pointer  flex justify-center items-center">
                                                <div class="w-18 h-6">
                                                    Check-ins
                                                </div>
                                            </div>
                                            <div class="w-18 rounded-md h-11 bg-[rgb(255,255,255)]  hover:bg-[rgb(242,242,242)] cursor-pointer  flex justify-center items-center">
                                                <div class="w-10 h-6 flex">
                                                    <div>
                                                        More
                                                    </div>
                                                    <div class="flex items-center">
                                                        <div class="w-3 h-4">
                                                            <svg viewBox="0 0 20 20" width="16" height="16" fill="currentColor" aria-hidden="true" class="xfx01vb x1lliihq x1tzjh5l x1k90msu x2h7rmj x1qfuztq" style="--color: var(--secondary-icon);"><path d="M10 14a1 1 0 0 1-.755-.349L5.329 9.182a1.367 1.367 0 0 1-.205-1.46A1.184 1.184 0 0 1 6.2 7h7.6a1.18 1.18 0 0 1 1.074.721 1.357 1.357 0 0 1-.2 1.457l-3.918 4.473A1 1 0 0 1 10 14z"></path></svg>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="w-110 h-9 bg-[rgb(255,255,255)] flex justify-end">
                                            <div class="w-20 h-9  flex justify-center items-center">
                                                <div class="h-9 w-13 rounded-md bg-[rgb(214,217,221)] cursor-pointer flex justify-center items-center">
                                                    <div class="w-4 h-4">
                                                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" aria-hidden="true" class="xfx01vb x1lliihq x1tzjh5l x1k90msu x2h7rmj x1qfuztq" style="--color: var(--primary-icon);"><circle cx="12" cy="12" r="2.5"></circle><circle cx="19.5" cy="12" r="2.5"></circle><circle cx="4.5" cy="12" r="2.5"></circle></svg>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="w-full h-60 bg-[rgb(242,244,247)] flex justify-center items-center">
                                <div class="w-240 h-54 bg-[rgb(242,244,247)]">
                                    <div class="w-240 h-22 bg-[rgb(242,244,247)] flex justify-around items-center">
                                        <div class="w-90 h-17 bg-[rgb(255,255,255)] flex items-center rounded-md">
                                            <div class="w-22 h-9  font-[700] text-2xl flex justify-center items-center">
                                                <div class="w-14 h-9">
                                                    Intro
                                                </div>
                                            </div>
                                        </div>
                                        <div class="w-140 h-17 bg-[rgb(255,255,255)] rounded-md flex items-center">
                                            <div class="w-22 h-9  font-[700] text-2xl flex justify-center items-center">
                                                <div class="w-14 h-9 ">
                                                    Posts
                                                </div>
                                            </div>
                                            <div class="w-130 h-13  flex justify-end">
                                                <div class="w-35 h-13 flex justify-center items-center">
                                                    <div class="w-22 bg-[rgb(214,217,221)] cursor-pointer h-9 rounded-md flex justify-center items-center">
                                                        <div class="flex w-19 justify-around h-7">
                                                            <div class="w-5 flex justify-center items-center">
                                                                <div class="h-6">
                                                                    <i data-visualcompletion="css-img" class="x1b0d499 xep6ejk" aria-hidden="true" style="background-image:url('https://static.xx.fbcdn.net/rsrc.php/v4/yL/r/4O3qh5ZzCQm.png');background-position:0 -194px;background-size:auto;width:16px;height:16px;background-repeat:no-repeat;display:inline-block"></i>
                                                                </div>
                                                            </div>
                                                            <div class="font-[600]">
                                                                Filters
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="w-240 h-24 bg-[rgb(242,244,247)]  rounded-md flex items-center">
                                        <div class="w-95 flex justify-center"> 
                                            <div class="w-90 h-17 bg-[rgb(255,255,255)]  rounded-md flex items-center">
                                                <div class="w-25 h-9  font-[700] text-2xl flex justify-center items-center">
                                                    <div class="w-16 h-9 hover:underline cursor-pointer">
                                                        Photos
                                                    </div>
                                                </div>
                                                <div class="w-60 h-17  flex justify-end">
                                                    <div class="w-30 h-17  rounded-md  flex items-center">
                                                        <div class="text-lg cursor-pointer flex items-center h-10  text-blue-600">
                                                            <div class="h-11 w-30 rounded-md hover:bg-[rgb(242,242,242)] flex items-center justify-center">
                                                                <div class="w-29">
                                                                    <div class="h-7">
                                                                        See All Photos
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="w-140 h-17 bg-[rgb(242,244,247)]  rounded-md flex justify-center">
                                            <div class="text-2xl font-[700] w-55 h-10">
                                                No posts available
                                            </div>
                                        </div>
                                    </div>
                                    <div class="w-90 h-9  text-sm flex flex-col text-xs flex justify-around">
                                        <div class="flex justify-around h-5 ">
                                            <div class="font-[600] text-[rgb(101,104,108)] cursor-pointer hover:underline">
                                                Privacy   
                                            </div>
                                            <div>
                                                ·
                                            </div>
                                            <div class="font-[600] text-[rgb(101,104,108)] cursor-pointer hover:underline">
                                                Terms
                                            </div>
                                            <div>
                                                ·
                                            </div>
                                            <div class="font-[600] text-[rgb(101,104,108)] cursor-pointer hover:underline">
                                                Advertising
                                            </div>
                                            <div>
                                                ·
                                            </div>
                                            <div class="font-[600] text-[rgb(101,104,108)] cursor-pointer hover:underline">
                                                Ad choices
                                            </div>
                                            <div>
                                                <i data-visualcompletion="css-img" class="x1b0d499 x1d69dk1" style="background-image: url(&quot;https://static.xx.fbcdn.net/rsrc.php/v4/yL/r/4O3qh5ZzCQm.png&quot;); background-position: 0px -313px; background-size: auto; width: 12px; height: 12px; background-repeat: no-repeat; display: inline-block;"></i>
                                            </div>
                                            <div>
                                                .
                                            </div>
                                            <div class="font-[600] text-[rgb(101,104,108)] cursor-pointer hover:underline flex">
                                                Cookies 
                                            </div>
                                            <div class="flex justify-center items-center">
                                             </div>
                                            <div class="text-[rgb(107,110,115)] font-[300] cursor-pointer">
                                                More
                                            </div>
                                            <div class="flex justify-center items-center">
                                                <div class="">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="h-4 text-xs flex">
                                            <div class="flex justify-between w-22">
                                                <div class="text-[rgb(107,110,115)] font-[300]">
                                                    Meta
                                                </div>
                                                <div class="text-[rgb(107,110,115)] font-[300]">
                                                     ©
                                                </div>
                                                <div class="text-[rgb(107,110,115)] font-[300]">
                                                    2025
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <%end%>
        <%end%>
    </div>
</div>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    function OpenProfileModal(Profileshow){  
        let parentprofile=document.getElementById("Parentprofilediv");
        const childElements = parentprofile.children;
        for(let i=0;i<childElements.length;++i){
            console.log(childElements[i],">>>>>>>>>>>>>>>>>>.s",i)
            console.log(childElements[i].id,".................");
            if(childElements[i].id!==Profileshow){
                console.log("hlow world");
                let profilehide=document.getElementById(childElements[i].id);
                if(profilehide.style.display==="block"){
                    profilehide.style.display="none";
                    console.log("if block run");
                }

            }
            else{
                console.log("DDDDDDDDDDDDDDD")
            }
        }
        let profileuser=document.getElementById(Profileshow);
        if(profileuser.style.display=="none"){
         profileuser.style.display="block";   
        }
        else{
         profileuser.style.display="none"   
        }
    }
    function Friendrequestdeclined(friendemail){
        data={userid:`<%=current_user.id%>`,currentuseremail:friendemail,user_id:`<%=current_user.id%>`,reqstatus:"declined"}
        axios.post('/friendrequestsent/friendrequestdelete',data)
            .then((response) => {
            if(response.status==200){
                 window.location.reload();
            } 
        }).catch(error => console.log(error.response.data));
    }
    function Friendrequestaccepted(friendemail){ 
        console.log("inside friend request method")
        data={userid:`<%=current_user.id%>`,currentuseremail:friendemail,user_id:`<%=current_user.id%>`,reqstatus:"accept"}
        axios.post('/friendrequestsent/friendrequestaccept',data)
        .then((response) => {
            if(response.status==200){ 
            window.location.reload();
            }
        })
        .catch(error => console.log(error.response.data));
    }
    function RequestSent(email,id){
        console.log("function request sent",email,"::::::::::",id);
        data={emails:email,userid:id,currentuseremail:`<%=current_user.email%>`,user_id:id,reqstatus:"pending"}
        axios.post('/friendrequestsent/friendrequestget',data)
        .then((response) => {
        if(response.status==200){ 
        window.location.reload();
        }
        })
        .catch(error => console.log(error.response.data));
    }
</script>